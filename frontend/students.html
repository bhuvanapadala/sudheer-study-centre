<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Students - Sudheer Study Centre</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #f9fafb;
      color: #333;
    }

    .main-heading {
      background-color: #4b0082;
      color: #fff;
      padding: 20px;
      text-align: center;
      font-size: 2.2rem;
      font-weight: bold;
    }

    .navbar {
      display: flex;
      justify-content: center;
      gap: 20px;
      background-color: #eee;
      padding: 15px 10px;
      flex-wrap: wrap;
    }

    .navbar a {
      background-color: #4b0082;
      color: #fff;
      padding: 10px 20px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 500;
      transition: background 0.3s ease;
    }

    .navbar a:hover,
    .navbar a.active {
      background-color: #9370db;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
      color: #1571cc;
    }


    .container {
      max-width: 900px;
      margin: 30px auto;
      padding: 20px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    .btn {
      background-color: #4b0082;
      color: #fff;
      padding: 10px 18px;
      border: none;
      border-radius: 6px;
      font-size: 15px;
      cursor: pointer;
      transition: background-color 0.3s;
      margin-bottom: 20px;
    }

    .btn:hover {
      background-color: #9370db;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }

    th, td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }

    th {
      background-color: #ecf0f1;
      color: #333;
      font-weight: 600;
    }

    tr:hover {
      background-color: #f9f9f9;
    }

    .actions button {
      padding: 6px 10px;
      margin-right: 5px;
      border: none;
      border-radius: 4px;
      font-size: 13px;
      cursor: pointer;
      color: #fff;
    }

    .view-btn {
      background-color: #007bff;
    }

    .edit-btn {
      background-color: #2e8b57;
    }

    .delete-btn {
      background-color: #cc3333;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(10, 10, 10, 0.5);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .modal-content {
      background: #fff;
      padding: 30px;
      border-radius: 10px;
      width: 90%;
      max-width: 400px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .modal-content h3 {
      margin-top: 0;
      font-size: 22px;
      color: #0a3d62;
      margin-bottom: 20px;
    }

    .modal-content input,
    .modal-content select {
      width: 100%;
      margin-bottom: 15px;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 14px;
    }

    .no-data {
      text-align: center;
      color: #aaa;
      padding: 20px;
    }

    /* Flashcard View */
    #flashcard {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: center;
      z-index: 2000;
    }

    .flashcard-content {
      background: #fff;
      padding: 20px 30px;
      border-radius: 10px;
      width: 90%;
      max-width: 400px;
      text-align: center;
      position: relative;
    }

    .flashcard-content h3 {
      margin-top: 0;
      color: #4b0082;
    }

    .flashcard-content p {
      font-size: 15px;
      margin: 8px 0;
    }

    .flashcard-content .close {
  position: absolute;
  top: -12px;
  right: -12px;
  background-color: #f44336;
  color: white;
  border-radius: 50%;
  font-size: 20px;
  width: 32px;
  height: 32px;
  text-align: center;
  line-height: 32px;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
  transition: transform 0.2s ease, background-color 0.2s ease;
}


    .filters {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  align-items: center;
  margin: 20px 0;
  padding: 10px;
  background-color: #f0f4f8;
  border-radius: 10px;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
}

.filters input,
.filters select {
  padding: 10px 15px;
  font-size: 16px;
  border: 1px solid #ccc;
  border-radius: 8px;
  flex: 1;
  min-width: 180px;
  max-width: 250px;
  transition: border 0.2s ease;
}

.filters input:focus,
.filters select:focus {
  outline: none;
  border-color: #1976d2;
  box-shadow: 0 0 4px rgba(25, 118, 210, 0.3);
}

.no-results {
  text-align: center;
  font-size: 18px;
  color: #888;
  margin-top: 40px;
}

@media (max-width: 768px) {
  .navbar {
    flex-direction: row;
    align-items: center;
    gap: 10px;
  }

  .container {
    margin: 20px 10px;
    padding: 15px;
    box-shadow: none;
    border-radius: 8px;
  }

  .btn {
    width: 100%;
    padding: 12px;
    font-size: 16px;
  }

  table {
    font-size: 13px;
    display: block;
    overflow-x: auto;
  }

  th, td {
    padding: 10px;
    white-space: nowrap;
  }

  .filters {
    flex-direction: column;
    align-items: stretch;
    gap: 10px;
    padding: 10px;
  }

  .filters input,
  .filters select {
    width: 100%;
    max-width: 100%;
    font-size: 15px;
  }

  .modal-content {
    width: 95%;
    padding: 20px;
  }

  .flashcard-content {
    width: 95%;
    padding: 15px;
  }

  .actions button {
    padding: 8px 12px;
    font-size: 14px;
    margin-bottom: 5px;
  }
}

  </style>
</head>
<body>

  <header style="display: flex; align-items: center; justify-content: space-between; padding: 10px; background-color: #4b0082; color: white;">
  <div class="main-heading">
    Sudheer Study Centre
  </div>

  <div class="profile-dropdown" style="position: relative;">
    <img src="https://ui-avatars.com/api/?name=SS&background=ffffff&color=000000&rounded=true&size=40" alt="Profile" class="profile-icon" style="width: 40px; height: 40px; border-radius: 50%; cursor: pointer;" />

    <div class="profile-menu" style="display: none; position: absolute; right: 0; background: white; color: black; box-shadow: 0 4px 8px rgba(0,0,0,0.2); border-radius: 8px; padding: 10px; margin-top: 8px; min-width: 100px; z-index: 100;">
      <a href="#" id="logoutBtn" style="display: block; padding: 8px; text-decoration: none; color: #4b0082;">Logout</a>
    </div>
  </div>
</header>

  <div class="navbar">
    <a href="index.html">Dashboard</a>
    <a href="students.html" class="active">Students</a>
    <a href="fees.html">Fees</a>
    <a href="report.html">Reports</a>
  </div>
  <h1>Student Details</h1>
  <div class="filters">
  <input type="text" id="searchInput" placeholder="Search by Name" />

  <select id="filterSchool">
    <option value="">All Schools</option>
    <option>Sudheer Kids School</option>
    <option>Sudheer EM School</option>
    <option>Pragati Vidya Niketan</option>
    <option>Government School</option>
    <option>Minerva EM School</option>
    <option>Aditya EM School</option>
    <option>St.Ann's School</option>
    <option>Sri Shirdi Sai Vidya Niketan</option>
    <option>Dafne</option>
    <option>Rajamahendri International School</option>
    <option>Delhi Public School</option>
    <option>Future Kids School</option>
    <option>Dreams School</option>
    <option>SR School</option>
    <option>Other</option>
  </select>

  <select id="filterPlace">
    <option value="">All Places</option>
    <option>Kadiyapulanka</option>
    <option>Burrilanka</option>
  </select>
</div>


  <div class="container">
    <button class="btn" onclick="openModal()">+ Add Student</button>

    <table id="studentsTable">
      <thead>
        <tr>
          <th>S.No</th>
          <th>Name</th>
          <th>Class</th>
          <th>School</th>
          <th>Mobile</th>
          <th>Monthly Fee</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="studentBody"></tbody>
    </table>
    <p class="no-results" id="noResults" style="display:none">No students found.</p>
  </div>

  <!-- Modal -->
  <div class="modal" id="studentModal">
    <div class="modal-content">
      <h3 id="modalTitle">Add Student</h3>
      <input type="text" id="name" placeholder="Student Name">
      <input type="text" id="mobile" placeholder="Mobile Number">
      <div class="filters">

      <select id="studentClass">
        <option value="">Select Class</option>
        <option>LKG</option>
        <option>UKG</option>
        <option>1st</option>
        <option>2nd</option>
        <option>3rd</option>
        <option>4th</option>
        <option>5th</option>
        <option>6th</option>
        <option>7th</option>
        <option>8th</option>
        <option>9th</option>
        <option>Other</option>
      </select>
      <select id="school">
          <option value="">All Schools</option>
          <option>Sudheer Kids School</option>
          <option>Sudheer EM School</option>
          <option>Pragati Vidya Niketan</option>
          <option>Government School</option>
          <option>Minerva EM School</option>
          <option>Aditya EM School</option>
          <option>St.Ann's School</option>
          <option>Sri Shirdi Sai Vidya Niketan</option>
          <option>Dafne</option>
          <option>Rajamahendri International School</option>
          <option>Delhi Public School</option>
          <option>Future Kids School</option>
          <option>Dreams School</option>
          <option>SR School</option>
          <option>Other</option>
        </select>
        <select id="place">
          <option value="">All Places</option>
          <option>Kadiyapulanka</option>
          <option>Burrilanka</option>
        </select>
        <select id="fee">
        <option value="">Monthly Fee</option>
        <option>400</option>
        <option>500</option>
        <option>600</option>
      </select>
      </div>
      <button class="btn" id="saveBtn" onclick="saveStudent()">Save</button>
      <button class="btn" id="cancelBtn" onclick="closeModal()">Cancel</button>
    </div>
  </div>




  <!-- Flashcard -->
  <div id="flashcard">
    <div class="flashcard-content" id="viewContent">
      <span class="close" onclick="closeFlashcard()">&times;</span>
    </div>
  </div>

  
<script>
  const API_URL = 'http://localhost:5000/api/students';
  const name = document.getElementById("name");
  const mobile = document.getElementById("mobile");
  const studentBody = document.getElementById("studentBody");
  const studentClass = document.getElementById("studentClass");
  const school = document.getElementById("school");
  const place = document.getElementById("place");
  const fee = document.getElementById("fee");
  const searchInput = document.getElementById("searchInput");
  const filterSchool = document.getElementById("filterSchool");
  const filterPlace = document.getElementById("filterPlace");
  const noResults = document.getElementById("noResults");

  let students = [];
  let editingId = null;

  async function loadStudents() {
    const res = await fetch(API_URL);
    students = await res.json();
    renderStudents();
  }

  function renderStudents() {
    studentBody.innerHTML = "";
    const search = searchInput.value.toLowerCase();
    const schoolFilter = filterSchool.value;
    const placeFilter = filterPlace.value;

    const filtered = students.filter(s => (
      s.name.toLowerCase().includes(search) &&
      (schoolFilter === '' || s.school === schoolFilter) &&
      (placeFilter === '' || s.place === placeFilter)
    ));

    noResults.style.display = filtered.length ? "none" : "block";

    filtered.forEach((s, i) => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${i + 1}</td>
        <td>${s.name}</td>
        <td>${s.class}</td>
        <td>${s.school}</td>
        <td>${s.mobile}</td>
        <td>₹${s.fee}</td>
        <td class="actions">
          <button class="view-btn" onclick='viewStudent(${JSON.stringify(s)})'>View</button>
          <button class="edit-btn" onclick='editStudent(${JSON.stringify(s)})'>Edit</button>
          <button class="delete-btn" onclick='deleteStudent("${s._id}")'>Delete</button>
        </td>
      `;
      studentBody.appendChild(row);
    });
  }

  function openModal() {
    editingId = null;
    document.getElementById("studentModal").style.display = "flex";
    document.getElementById("modalTitle").textContent = "Add Student";

    // ✅ reset fields
    name.value = "";
    mobile.value = "";
    studentClass.value = "";
    school.value = "";
    place.value = "";
    fee.value = "";
  }

  function closeModal() {
    document.getElementById("studentModal").style.display = "none";
  }

  function closeFlashcard() {
    document.getElementById("flashcard").style.display = "none";
  }

  async function saveStudent() {
    const student = {
      name: name.value,
      mobile: mobile.value,
      class: studentClass.value,
      school: school.value,
      place: place.value,
      fee: parseInt(fee.value)
    };

    try {
      if (editingId) {
        await fetch(`${API_URL}/${editingId}`, {
          method: 'PUT',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(student)
        });
      } else {
        await fetch(API_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(student)
        });
      }

      closeModal();
      loadStudents();
    } catch (err) {
      alert("Error saving student.");
      console.error(err);
    }
  }

  function viewStudent(s) {
    const flash = document.getElementById("flashcard");
    const view = document.getElementById("viewContent");
    view.innerHTML = `
      <span class="close" onclick="closeFlashcard()">&times;</span>
      <h3>${s.name}</h3>
      <p>Class: ${s.class}</p>
      <p>School: ${s.school}</p>
      <p>Place: ${s.place}</p>
      <p>Mobile: ${s.mobile}</p>
      <p>Monthly Fee: ₹${s.fee}</p>
    `;
    flash.style.display = "flex";
  }

  function editStudent(s) {
    editingId = s._id;
    name.value = s.name;
    mobile.value = s.mobile;
    studentClass.value = s.class;
    school.value = s.school;
    place.value = s.place;
    fee.value = s.fee;
    openModal();
    document.getElementById("modalTitle").textContent = "Edit Student";
  }

  async function deleteStudent(id) {
    if (confirm("Are you sure you want to delete this student?")) {
      await fetch(`${API_URL}/${id}`, { method: 'DELETE' });
      loadStudents();
    }
  }
   
  
  const profileIcon = document.querySelector('.profile-icon');
  const profileMenu = document.querySelector('.profile-menu');
  const logoutBtn = document.getElementById('logoutBtn');

  // Show/hide profile menu when profile icon clicked
  profileIcon.addEventListener('click', () => {
    profileMenu.style.display = profileMenu.style.display === 'block' ? 'none' : 'block';
  });

  // Logout and redirect to login.html
  logoutBtn.addEventListener('click', (e) => {
    e.preventDefault(); // prevent default anchor behavior
    window.location.href = "login.html";
  });

  // Optional: Hide menu if clicked outside
  document.addEventListener('click', (e) => {
    if (!e.target.closest('.profile-dropdown')) {
      profileMenu.style.display = 'none';
    }
  });



  [searchInput, filterSchool, filterPlace].forEach(input => input.addEventListener("input", renderStudents));

  loadStudents();
</script>

</body>
</html>
